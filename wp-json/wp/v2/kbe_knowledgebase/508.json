{"id":508,"date":"2016-12-21T02:21:37","date_gmt":"2016-12-21T02:21:37","guid":{"rendered":"http:\/\/gonomad.wpengine.com\/?post_type=kbe_knowledgebase&#038;p=135"},"modified":"2018-06-18T15:31:34","modified_gmt":"2018-06-18T20:31:34","slug":"active-directory-sites","status":"publish","type":"kbe_knowledgebase","link":"https:\/\/nomad.menu\/help\/active-directory-sites\/","title":{"rendered":"Active Directory Sites"},"content":{"rendered":"<h2><strong style=\"font-size: 20px; line-height: 1.6em;\">AD Site Awareness<\/strong><\/h2>\n<p>NoMAD is AD site-aware and will use them when determining which AD Domain Controller (DC) to use.<\/p>\n<h2 style=\"font-size: 16px; line-height: 1.75em;\"><strong style=\"font-size: 20px; line-height: 1.6em;\">What Is a &#8220;Site&#8221;?<\/strong><\/h2>\n<p style=\"font-size: 16px; line-height: 1.75em;\">Active Directory uses sites to best determine what the closest DC to your system is. Sites are listed within AD by their CIDR network address, e.g. 192.168.128.0\/23. AD specifies the name of a site to be used under each of these subnet objects. The site name corresponds to a site object which lists DCs that should be used within that particular site.<\/p>\n<h2 style=\"font-size: 16px; line-height: 1.75em;\"><strong style=\"font-size: 20px; line-height: 1.6em;\">How Does NoMAD Work With Sites?<\/strong><\/h2>\n<p style=\"font-size: 16px; line-height: 1.75em;\">When first discovering what DCs exist for a network, NoMAD does a DNS SRV record lookup for that domain.<\/p>\n<p style=\"font-size: 16px; line-height: 1.75em;\"><code>dig +short -t SRV _ldap._tcp.domain.com<\/code><\/p>\n<p style=\"font-size: 16px; line-height: 1.75em;\">This returns a list of DCs that are authoritative for that AD Domain. NoMAD then takes the highest ranked server and perform an <a href=\"https:\/\/msdn.microsoft.com\/en-us\/library\/cc223811.aspx\">LDAP Ping<\/a> to that server. The reply to the ping contains a number of telematics about the AD environment, including what site the client should be in based upon how that client is reaching the DC.<\/p>\n<p style=\"font-size: 16px; line-height: 1.75em;\">If a site is found, NoMAD re-queries for SRV records specific to the DNS site.<\/p>\n<p style=\"font-size: 16px; line-height: 1.75em;\"><code>dig +short -t SRV _ldap._tcp.site._sites.domain.com<\/code><\/p>\n<p style=\"font-size: 16px; line-height: 1.75em;\">NoMAD then checks the results of the lookup for TCP and LDAP connectivity.<\/p>\n<p style=\"font-size: 16px; line-height: 1.75em;\">After finding a DC that works, NoMAD continues to use it until a network change occurs, at which point the process will start all over again. If that server stops responding at any time, NoMAD will go to the next server from the DNS lookup results, organized by weight, and attempt to use that one.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>AD Site Awareness NoMAD is AD site-aware and will use them when determining which AD Domain Controller (DC) to use. What Is a &#8220;Site&#8221;? Active Directory uses sites to best determine what the closest DC to your system is. Sites are listed within AD by their CIDR network address, e.g. 192.168.128.0\/23. AD specifies the name [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"closed","ping_status":"closed","template":"","kbe_taxonomy":[18],"kbe_tags":[],"_links":{"self":[{"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/kbe_knowledgebase\/508"}],"collection":[{"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/kbe_knowledgebase"}],"about":[{"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/types\/kbe_knowledgebase"}],"author":[{"embeddable":true,"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/comments?post=508"}],"version-history":[{"count":0,"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/kbe_knowledgebase\/508\/revisions"}],"wp:attachment":[{"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/media?parent=508"}],"wp:term":[{"taxonomy":"kbe_taxonomy","embeddable":true,"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/kbe_taxonomy?post=508"},{"taxonomy":"kbe_tags","embeddable":true,"href":"https:\/\/nomad.menu\/wp-json\/wp\/v2\/kbe_tags?post=508"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}